import b2
import backgammon
import pytest
import slow_but_right

move_computer = b2.MoveComputer()
mc_dumb = slow_but_right.MoveComputer()

from collections import namedtuple

Dark = backgammon.Color.Dark
Light = backgammon.Color.Light

Case = namedtuple(
    "TestCase",
    ["board", "roll", "expected_moves", "player_1_color", "player", "comment"],
    defaults=[Dark, Dark, ""],
)

test_cases = [
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
| ●           ○    |   | ○              ● |
| ●           ○    |   | ○              ● |
| ●           ○    |   | ○                |
| ●                |   | ○                |
| ●                |   | ○                |
|                  |BAR|                  |
| ○                |   | ●                |
| ○                |   | ●                |
| ○           ●    |   | ●                |
| ○           ●    |   | ●              ○ |
| ○           ●    |   | ●              ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(6, 5),
        expected_moves=[
            ((24, 18), (18, 13)),
            ((24, 18), (13, 8)),
            ((24, 18), (8, 3)),
            ((13, 8), (13, 7)),
            ((13, 8), (8, 2)),
            ((13, 7), (8, 3)),
            ((13, 7), (7, 2)),
            ((8, 3), (8, 2)),
        ],
        comment="starting position, rolled 65",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●              ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(6, 1),
        expected_moves=[
            ((6, 5), (5, -1)),
            ((6, 0), (1, 0)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●  ●           ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 2),
        expected_moves=[
            ((6, 4), (5, 0)),
            ((6, 1), (5, 3)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●  ●           ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(3, 2),
        expected_moves=[
            ((6, 4), (5, 2)),
            ((6, 4), (4, 1)),
            ((6, 3), (5, 3)),
            ((6, 3), (3, 1)),
            ((5, 3), (3, 0)),
            ((5, 2), (2, 0)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●  ●           ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(2, 2),
        expected_moves=[
            ((6, 4), (5, 3), (4, 2), (3, 1)),
            ((6, 4), (5, 3), (4, 2), (2, 0)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●                |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(1, 1),
        expected_moves=[((6, 5), (5, 4), (4, 3), (3, 2))],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●              ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(3, 1),
        expected_moves=[((6, 5), (5, 2)), ((6, 3), (3, 2)), ((6, 3), (1, 0))],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●              ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(1, 1),
        expected_moves=[
            ((6, 5), (5, 4), (4, 3), (3, 2)),
            ((6, 5), (5, 4), (4, 3), (1, 0)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|             ●  ● |   | ●                |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(6, 5),
        expected_moves=[
            ((8, 3), (7, 1)),
            ((8, 2), (7, 2)),
            ((8, 2), (6, 1)),
            ((7, 1), (6, 1)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |       ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(4, 2),
        expected_moves=[
            ((7, 5), (5, 1)),
            ((7, 5), (4, 0)),
            ((7, 3), (4, 2)),
            ((7, 3), (3, 1)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |       ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 1),
        expected_moves=[((7, 6), (6, 1)), ((7, 2), (4, 3)), ((7, 2), (2, 1))],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |    ○             |
|                ● |   |    ○  ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(2, 4),
        expected_moves=[((7, 3), (4, 2)), ((7, 3), (3, 1))],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |    ○             |
|                ● |   |    ○  ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(1, 1),
        expected_moves=[
            ((7, 6), (4, 3), (3, 2), (2, 1)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |       ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(1, 1),
        expected_moves=[
            ((7, 6), (6, 5), (5, 4), (4, 3)),
            ((7, 6), (6, 5), (4, 3), (3, 2)),
            ((7, 6), (4, 3), (3, 2), (2, 1)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |                ○ |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |    ●             |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(1, 1),
        expected_moves=[
            ((7, 6), (6, 5), (5, 4), (5, 4)),
            ((7, 6), (6, 5), (5, 4), (4, 3)),
            ((7, 6), (5, 4), (4, 3), (3, 2)),
            ((5, 4), (4, 3), (3, 2), (2, 1)),
        ],
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
| ○  ●        ●    | ○ | ●     ●        ○ |
| ○  ●        ●    |   | ●     ●          |
| ○           ●    |   | ●                |
| ○                |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   | ○                |
|                  |   | ○                |
| ●           ○    |   | ○                |
| ●           ○    |   | ○              ● |
| ●        ○  ○    |   | ○              ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(2, 2),
        expected_moves=[
            ((25, 23), (24, 22), (22, 20), (20, 18)),
            ((25, 23), (24, 22), (22, 20), (13, 11)),
            ((25, 23), (24, 22), (22, 20), (9, 7)),
            ((25, 23), (24, 22), (22, 20), (8, 6)),
            ((25, 23), (24, 22), (22, 20), (6, 4)),
            ((25, 23), (24, 22), (13, 11), (13, 11)),
            ((25, 23), (24, 22), (13, 11), (11, 9)),
            ((25, 23), (24, 22), (13, 11), (9, 7)),
            ((25, 23), (24, 22), (13, 11), (8, 6)),
            ((25, 23), (24, 22), (13, 11), (6, 4)),
            ((25, 23), (24, 22), (9, 7), (8, 6)),
            ((25, 23), (24, 22), (9, 7), (7, 5)),
            ((25, 23), (24, 22), (9, 7), (6, 4)),
            ((25, 23), (24, 22), (8, 6), (8, 6)),
            ((25, 23), (24, 22), (8, 6), (6, 4)),
            ((25, 23), (24, 22), (6, 4), (6, 4)),
            ((25, 23), (24, 22), (6, 4), (4, 2)),
            ((25, 23), (13, 11), (13, 11), (13, 11)),
            ((25, 23), (13, 11), (13, 11), (11, 9)),
            ((25, 23), (13, 11), (13, 11), (9, 7)),
            ((25, 23), (13, 11), (13, 11), (8, 6)),
            ((25, 23), (13, 11), (13, 11), (6, 4)),
            ((25, 23), (13, 11), (11, 9), (9, 7)),
            ((25, 23), (13, 11), (11, 9), (8, 6)),
            ((25, 23), (13, 11), (11, 9), (6, 4)),
            ((25, 23), (13, 11), (9, 7), (8, 6)),
            ((25, 23), (13, 11), (9, 7), (7, 5)),
            ((25, 23), (13, 11), (9, 7), (6, 4)),
            ((25, 23), (13, 11), (8, 6), (8, 6)),
            ((25, 23), (13, 11), (8, 6), (6, 4)),
            ((25, 23), (13, 11), (6, 4), (6, 4)),
            ((25, 23), (13, 11), (6, 4), (4, 2)),
            ((25, 23), (9, 7), (8, 6), (8, 6)),
            ((25, 23), (9, 7), (8, 6), (7, 5)),
            ((25, 23), (9, 7), (8, 6), (6, 4)),
            ((25, 23), (9, 7), (7, 5), (6, 4)),
            ((25, 23), (9, 7), (7, 5), (5, 3)),
            ((25, 23), (9, 7), (6, 4), (6, 4)),
            ((25, 23), (9, 7), (6, 4), (4, 2)),
            ((25, 23), (8, 6), (8, 6), (8, 6)),
            ((25, 23), (8, 6), (8, 6), (6, 4)),
            ((25, 23), (8, 6), (6, 4), (6, 4)),
            ((25, 23), (8, 6), (6, 4), (4, 2)),
            ((25, 23), (6, 4), (6, 4), (6, 4)),
            ((25, 23), (6, 4), (6, 4), (4, 2)),
        ],
        player_1_color=Light,
        player=Light,
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
| ○           ●    | ○ | ●           ●  ○ |
| ○           ●    |   | ●           ●    |
| ○                |   | ●                |
| ○                |   | ●                |
|                  |   |                  |
|                  |BAR|                  |
| ●                |   | ○                |
| ●           ○    |   | ○                |
| ●           ○    |   | ○                |
| ●           ○    |   | ○              ● |
| ●           ○    |   | ○              ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 4),
        expected_moves=[
            ((25, 21), (21, 16)),
            ((25, 21), (13, 8)),
            ((25, 21), (8, 3)),
            ((25, 20), (24, 20)),
            ((25, 20), (20, 16)),
            ((25, 20), (13, 9)),
            ((25, 20), (8, 4)),
            ((25, 20), (6, 2)),
        ],
        player_1_color=Light,
        player=Light,
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
| ○           ○    |   | ●        ○  ●    |
| ○                |   | ●           ●    |
| ○                |   | ●           ●    |
| ○                |   |                  |
| ○                |   |                  |
|                  |BAR|                  |
| ●                |   | ○                |
| ●                |   | ○                |
| ●           ○    |   | ○                |
| ●           ○    | ● | ○              ● |
| ●           ○    | ● | ○              ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(2, 1),
        expected_moves=[((25, 24), (25, 23))],
        player_1_color=Light,
        player=Dark,
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |       ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(6, 5),
        expected_moves=[((7, 2), (4, -2)), ((7, 1), (4, -1))],
        player_1_color=Dark,
        player=Dark,
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |                  |
|                ● |   |                  |
|                ● |   | ●     ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 5),
        expected_moves=[((7, 2), (7, 2), (7, 2), (6, 1))],
        player_1_color=Dark,
        player=Dark,
        comment="move bear 3 in, move the 6 to the 1",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|             ●    |   |                  |
|             ●    |   |                  |
|             ●    |   | ●     ●          |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 5),
        expected_moves=[((8, 3), (8, 3), (8, 3), (6, 1))],
        player_1_color=Dark,
        player=Dark,
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                ○ |
|                  |   | ●     ●        ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 5),
        expected_moves=[],
        player_1_color=Dark,
        player=Dark,
        comment="cant move",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                ○ |
|                ● |   | ●     ●        ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 5),
        expected_moves=[((7, 2),)],
        player_1_color=Dark,
        player=Dark,
        comment="bear 1 in",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |                ○ |
|                ● |   | ●     ●        ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 5),
        expected_moves=[((7, 2), (7, 2))],
        player_1_color=Dark,
        player=Dark,
        comment="bear 2 in",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                ● |   |                  |
|                ● |   |                ○ |
|                ● |   | ●     ●        ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 5),
        expected_moves=[((7, 2), (7, 2), (7, 2))],
        player_1_color=Dark,
        player=Dark,
        comment="bear 3 in",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  |   |          ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                ● |   |                  |
|                ● |   |                  |
|                ● |   |                ○ |
|                ● |   | ●     ●        ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(5, 5),
        expected_moves=[((7, 2), (7, 2), (7, 2), (7, 2))],
        player_1_color=Dark,
        player=Dark,
        comment="bear 4 in",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
| ●                |   | ●        ○       |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●                |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(6, 6),
        expected_moves=[((19, 13), (13, 7), (13, 7), (7, 1))],
        player_1_color=Dark,
        player=Dark,
        comment="",
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  | ○ | ●     ●          |
|                  |   | ●     ●          |
|                  |   | ●                |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(2, 1),
        expected_moves=[((25, 24), (24, 22)), ((25, 23), (23, 22))],
        player_1_color=Light,
        player=Light,
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
|                  | ○ | ●     ●          |
|                  |   | ●     ●          |
|                  |   | ●                |
|                  |   |                  |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                ○ |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(3, 1),
        expected_moves=[((25, 22),)],
        player_1_color=Light,
        player=Light,
    ),
    Case(
        board="""___________________________________________
|                  |   |                  |
|13 14 15 16 17 18 |   |19 20 21 22 23 24 |
| ●                |   |    ○     ○  ●  ○ |
|                  |   |    ○     ○  ●  ○ |
|                  |   |    ○     ○     ○ |
|                  |   |          ○       |
|                  |   |                  |
|                  |BAR|                  |
|                  |   |                  |
|                  |   |                  |
|                  |   |                  |
|                  |   | ●     ●  ●  ●  ● |
|             ●    |   | ●  ●  ●  ●  ●  ● |
|12 11 10  9  8  7 |   | 6  5  4  3  2  1 |
|__________________|___|__________________|
""",
        roll=(2, 2),
        expected_moves=[
            ((23, 21), (23, 21), (21, 19), (21, 19)),
            ((23, 21), (23, 21), (21, 19), (19, 17)),
            ((23, 21), (23, 21), (21, 19), (13, 11)),
            ((23, 21), (23, 21), (21, 19), (8, 6)),
            ((23, 21), (23, 21), (21, 19), (6, 4)),
            ((23, 21), (23, 21), (21, 19), (5, 3)),
            ((23, 21), (23, 21), (21, 19), (4, 2)),
            ((23, 21), (23, 21), (21, 19), (3, 1)),
            ((23, 21), (23, 21), (13, 11), (11, 9)),
            ((23, 21), (23, 21), (13, 11), (8, 6)),
            ((23, 21), (23, 21), (13, 11), (6, 4)),
            ((23, 21), (23, 21), (13, 11), (5, 3)),
            ((23, 21), (23, 21), (13, 11), (4, 2)),
            ((23, 21), (23, 21), (13, 11), (3, 1)),
            ((23, 21), (23, 21), (8, 6), (6, 4)),
            ((23, 21), (23, 21), (8, 6), (5, 3)),
            ((23, 21), (23, 21), (8, 6), (4, 2)),
            ((23, 21), (23, 21), (8, 6), (3, 1)),
            ((23, 21), (23, 21), (6, 4), (6, 4)),
            ((23, 21), (23, 21), (6, 4), (5, 3)),
            ((23, 21), (23, 21), (6, 4), (4, 2)),
            ((23, 21), (23, 21), (6, 4), (3, 1)),
            ((23, 21), (23, 21), (5, 3), (4, 2)),
            ((23, 21), (23, 21), (5, 3), (3, 1)),
            ((23, 21), (23, 21), (4, 2), (4, 2)),
            ((23, 21), (23, 21), (4, 2), (3, 1)),
            ((23, 21), (23, 21), (3, 1), (3, 1)),
            ((23, 21), (21, 19), (19, 17), (17, 15)),
            ((23, 21), (21, 19), (19, 17), (13, 11)),
            ((23, 21), (21, 19), (19, 17), (8, 6)),
            ((23, 21), (21, 19), (19, 17), (6, 4)),
            ((23, 21), (21, 19), (19, 17), (5, 3)),
            ((23, 21), (21, 19), (19, 17), (4, 2)),
            ((23, 21), (21, 19), (19, 17), (3, 1)),
            ((23, 21), (21, 19), (13, 11), (11, 9)),
            ((23, 21), (21, 19), (13, 11), (8, 6)),
            ((23, 21), (21, 19), (13, 11), (6, 4)),
            ((23, 21), (21, 19), (13, 11), (5, 3)),
            ((23, 21), (21, 19), (13, 11), (4, 2)),
            ((23, 21), (21, 19), (13, 11), (3, 1)),
            ((23, 21), (21, 19), (8, 6), (6, 4)),
            ((23, 21), (21, 19), (8, 6), (5, 3)),
            ((23, 21), (21, 19), (8, 6), (4, 2)),
            ((23, 21), (21, 19), (8, 6), (3, 1)),
            ((23, 21), (21, 19), (6, 4), (6, 4)),
            ((23, 21), (21, 19), (6, 4), (5, 3)),
            ((23, 21), (21, 19), (6, 4), (4, 2)),
            ((23, 21), (21, 19), (6, 4), (3, 1)),
            ((23, 21), (21, 19), (5, 3), (4, 2)),
            ((23, 21), (21, 19), (5, 3), (3, 1)),
            ((23, 21), (21, 19), (4, 2), (4, 2)),
            ((23, 21), (21, 19), (4, 2), (3, 1)),
            ((23, 21), (21, 19), (3, 1), (3, 1)),
            ((23, 21), (13, 11), (11, 9), (9, 7)),
            ((23, 21), (13, 11), (11, 9), (8, 6)),
            ((23, 21), (13, 11), (11, 9), (6, 4)),
            ((23, 21), (13, 11), (11, 9), (5, 3)),
            ((23, 21), (13, 11), (11, 9), (4, 2)),
            ((23, 21), (13, 11), (11, 9), (3, 1)),
            ((23, 21), (13, 11), (8, 6), (6, 4)),
            ((23, 21), (13, 11), (8, 6), (5, 3)),
            ((23, 21), (13, 11), (8, 6), (4, 2)),
            ((23, 21), (13, 11), (8, 6), (3, 1)),
            ((23, 21), (13, 11), (6, 4), (6, 4)),
            ((23, 21), (13, 11), (6, 4), (5, 3)),
            ((23, 21), (13, 11), (6, 4), (4, 2)),
            ((23, 21), (13, 11), (6, 4), (3, 1)),
            ((23, 21), (13, 11), (5, 3), (4, 2)),
            ((23, 21), (13, 11), (5, 3), (3, 1)),
            ((23, 21), (13, 11), (4, 2), (4, 2)),
            ((23, 21), (13, 11), (4, 2), (3, 1)),
            ((23, 21), (13, 11), (3, 1), (3, 1)),
            ((23, 21), (8, 6), (6, 4), (6, 4)),
            ((23, 21), (8, 6), (6, 4), (5, 3)),
            ((23, 21), (8, 6), (6, 4), (4, 2)),
            ((23, 21), (8, 6), (6, 4), (3, 1)),
            ((23, 21), (8, 6), (5, 3), (4, 2)),
            ((23, 21), (8, 6), (5, 3), (3, 1)),
            ((23, 21), (8, 6), (4, 2), (4, 2)),
            ((23, 21), (8, 6), (4, 2), (3, 1)),
            ((23, 21), (8, 6), (3, 1), (3, 1)),
            ((23, 21), (6, 4), (6, 4), (5, 3)),
            ((23, 21), (6, 4), (6, 4), (4, 2)),
            ((23, 21), (6, 4), (6, 4), (3, 1)),
            ((23, 21), (6, 4), (5, 3), (4, 2)),
            ((23, 21), (6, 4), (5, 3), (3, 1)),
            ((23, 21), (6, 4), (4, 2), (4, 2)),
            ((23, 21), (6, 4), (4, 2), (3, 1)),
            ((23, 21), (6, 4), (3, 1), (3, 1)),
            ((23, 21), (5, 3), (4, 2), (4, 2)),
            ((23, 21), (5, 3), (4, 2), (3, 1)),
            ((23, 21), (5, 3), (3, 1), (3, 1)),
            ((23, 21), (4, 2), (4, 2), (3, 1)),
            ((23, 21), (4, 2), (3, 1), (3, 1)),
            ((13, 11), (11, 9), (9, 7), (8, 6)),
            ((13, 11), (11, 9), (9, 7), (7, 5)),
            ((13, 11), (11, 9), (9, 7), (6, 4)),
            ((13, 11), (11, 9), (9, 7), (5, 3)),
            ((13, 11), (11, 9), (9, 7), (4, 2)),
            ((13, 11), (11, 9), (9, 7), (3, 1)),
            ((13, 11), (11, 9), (8, 6), (6, 4)),
            ((13, 11), (11, 9), (8, 6), (5, 3)),
            ((13, 11), (11, 9), (8, 6), (4, 2)),
            ((13, 11), (11, 9), (8, 6), (3, 1)),
            ((13, 11), (11, 9), (6, 4), (6, 4)),
            ((13, 11), (11, 9), (6, 4), (5, 3)),
            ((13, 11), (11, 9), (6, 4), (4, 2)),
            ((13, 11), (11, 9), (6, 4), (3, 1)),
            ((13, 11), (11, 9), (5, 3), (4, 2)),
            ((13, 11), (11, 9), (5, 3), (3, 1)),
            ((13, 11), (11, 9), (4, 2), (4, 2)),
            ((13, 11), (11, 9), (4, 2), (3, 1)),
            ((13, 11), (11, 9), (3, 1), (3, 1)),
            ((13, 11), (8, 6), (6, 4), (6, 4)),
            ((13, 11), (8, 6), (6, 4), (5, 3)),
            ((13, 11), (8, 6), (6, 4), (4, 2)),
            ((13, 11), (8, 6), (6, 4), (3, 1)),
            ((13, 11), (8, 6), (5, 3), (4, 2)),
            ((13, 11), (8, 6), (5, 3), (3, 1)),
            ((13, 11), (8, 6), (4, 2), (4, 2)),
            ((13, 11), (8, 6), (4, 2), (3, 1)),
            ((13, 11), (8, 6), (3, 1), (3, 1)),
            ((13, 11), (6, 4), (6, 4), (5, 3)),
            ((13, 11), (6, 4), (6, 4), (4, 2)),
            ((13, 11), (6, 4), (6, 4), (3, 1)),
            ((13, 11), (6, 4), (5, 3), (4, 2)),
            ((13, 11), (6, 4), (5, 3), (3, 1)),
            ((13, 11), (6, 4), (4, 2), (4, 2)),
            ((13, 11), (6, 4), (4, 2), (3, 1)),
            ((13, 11), (6, 4), (3, 1), (3, 1)),
            ((13, 11), (5, 3), (4, 2), (4, 2)),
            ((13, 11), (5, 3), (4, 2), (3, 1)),
            ((13, 11), (5, 3), (3, 1), (3, 1)),
            ((13, 11), (4, 2), (4, 2), (3, 1)),
            ((13, 11), (4, 2), (3, 1), (3, 1)),
            ((8, 6), (6, 4), (6, 4), (6, 4)),
            ((8, 6), (6, 4), (6, 4), (5, 3)),
            ((8, 6), (6, 4), (6, 4), (4, 2)),
            ((8, 6), (6, 4), (6, 4), (3, 1)),
            ((8, 6), (6, 4), (5, 3), (4, 2)),
            ((8, 6), (6, 4), (5, 3), (3, 1)),
            ((8, 6), (6, 4), (4, 2), (4, 2)),
            ((8, 6), (6, 4), (4, 2), (3, 1)),
            ((8, 6), (6, 4), (3, 1), (3, 1)),
            ((8, 6), (5, 3), (4, 2), (4, 2)),
            ((8, 6), (5, 3), (4, 2), (3, 1)),
            ((8, 6), (5, 3), (3, 1), (3, 1)),
            ((8, 6), (4, 2), (4, 2), (3, 1)),
            ((8, 6), (4, 2), (3, 1), (3, 1)),
            ((6, 4), (6, 4), (5, 3), (4, 2)),
            ((6, 4), (6, 4), (5, 3), (3, 1)),
            ((6, 4), (6, 4), (4, 2), (4, 2)),
            ((6, 4), (6, 4), (4, 2), (3, 1)),
            ((6, 4), (6, 4), (3, 1), (3, 1)),
            ((6, 4), (5, 3), (4, 2), (4, 2)),
            ((6, 4), (5, 3), (4, 2), (3, 1)),
            ((6, 4), (5, 3), (3, 1), (3, 1)),
            ((6, 4), (4, 2), (4, 2), (4, 2)),
            ((6, 4), (4, 2), (4, 2), (3, 1)),
            ((6, 4), (4, 2), (3, 1), (3, 1)),
            ((5, 3), (4, 2), (4, 2), (3, 1)),
            ((5, 3), (4, 2), (3, 1), (3, 1)),
            ((5, 3), (3, 1), (3, 1), (3, 1)),
            ((4, 2), (4, 2), (3, 1), (3, 1)),
        ],
        player_1_color=Dark,
        player=Dark,
    ),
]


@pytest.mark.parametrize("t", test_cases)
def tests(t):
    board = backgammon.from_str(t.board, player_1_color=t.player_1_color)
    state = (board, (t.player == t.player_1_color), t.roll)
    moves = move_computer.compute_moves(state)

    moves_dumb = mc_dumb.compute_moves(state)

    for x in moves_dumb:
        x.sort()
        x.reverse()
    moves_dumb = [tuple(x) for x in moves_dumb]
    moves_dumb.sort()
    moves_dumb.reverse()

    assert moves == t.expected_moves, t.comment
    assert moves_dumb == t.expected_moves, "DUMB: " + t.comment
